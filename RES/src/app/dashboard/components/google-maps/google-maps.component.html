<mat-expansion-panel [expanded]="scrollHelperService.expandedStatus" (afterCollapse)="disPatchSetInView(true)"
  (afterExpand)="disPatchSetInView(false)">
  <div class="prevent-scroll" *ngIf="!isPaginatedList" (click)="hideClickToEnable()" #clickToEnable>
    <span>Click to enable</span>
  </div>
  <mat-expansion-panel-header class="border-bottom-muted">
    <mat-panel-title class="icon-with-text" *ngIf="scrollHelperService.getViewState?.userSeesMe">
      <span class="mr-1">{{ componentConfigs.title }}</span>
      <mat-icon aria-label="Button that displays
            a tooltip when focused or hovered over" [mdePopoverTriggerFor]="appPopover" mdePopoverTriggerOn="hover">
        error
      </mat-icon>
      <mde-popover #appPopover="mdePopover" [mdePopoverOverlapTrigger]="false">
        <app-icons-with-text [text]="componentConfigs.description"></app-icons-with-text>
      </mde-popover>
    </mat-panel-title>
  </mat-expansion-panel-header>
  <ng-container>
    <agm-map [zoom]="zoom" [fitBounds]="fitBounds" mapTypeId="hybrid" [disableDefaultUI]="false" [zoomControl]="false">
      <!-- <ng-template *ngFor="let m of listData"> -->
      <!-- *ngIf="m.key | split:','; let aVariable" -->
      <ng-container *ngFor="let m of listData">
        <agm-marker *ngIf="m.key | split:','; let aVariable" [agmFitBounds]="fitBounds" [latitude]="aVariable[1]"
          [longitude]="aVariable[0]">
          <agm-snazzy-info-window [maxWidth]="500" [closeWhenOthersOpen]="true">
            <ng-template>
              <h3>{{aVariable[3]}}</h3>
              <a target="_blank"
                [href]="'https://qcat.wocat.net/en/wocat/technologies/view/'+aVariable[2]+'/'">View on Wocat website</a>
            </ng-template>

          </agm-snazzy-info-window>
        </agm-marker>
      </ng-container>


    </agm-map>
  </ng-container>
  <ngx-loading [show]="!loadingHits && scrollHelperService.loading"></ngx-loading>
</mat-expansion-panel>